
<ion-content>
    <div class="container">
        <ion-text color="primary">
            <h1>{{valorBotonHome}}</h1>
        </ion-text>
        <ion-searchbar [(ngModel)]="terminoBusqueda" placeholder="Buscar producto" show-clear-button="focus" (ionInput)="buscarProductos()"></ion-searchbar>

<!--Si el término de búsqueda está vacío, muestra lista de categorías independientemente de la acción-->
        @if (!terminoBusqueda && categoriaElegida===null){
        <ion-list>
            @for (p of listaPropiedades; track p){
                <ion-card (click)="buscarModelos(p)">      
                    <ion-card-header>
                        <ion-card-title>{{ p }}</ion-card-title>
                    </ion-card-header>
                </ion-card>    
            }
        </ion-list>
        }

        @if(!terminoBusqueda && categoriaElegida!=null && modeloElegido === null){
        <ion-list>
            @for (p of listaPropiedades; track p){
                <ion-card (click)="buscarColores(p)">       
                    <ion-card-header>
                        <ion-card-title>{{ p }}</ion-card-title>
                    </ion-card-header>
                </ion-card>       
            }
        </ion-list>
        }

        @if(!terminoBusqueda && modeloElegido!==null && colorElegido == null){
        <ion-list>
            @for (p of listaPropiedades; track p){
                <ion-card (click)="buscarTallas(p)">       
                    <ion-card-header>
                        <ion-card-title>{{ p }}</ion-card-title>
                    </ion-card-header>
                </ion-card>       
            }
        </ion-list>
        }

        @if(!terminoBusqueda && colorElegido!=null){
        <ion-list>
            @for (p of listaPropiedades; track p){
                <ion-card [routerLink]="paginaFinal" (click)="mostrarProducto(p)">       
                    <ion-card-header>
                        <ion-card-title>{{ p }}</ion-card-title>
                    </ion-card-header>
                </ion-card>       
            }
        </ion-list>
        }

        <!--Si el término de búsqueda tiene cualquier cosa, busca en el array de productos filtrados-->
        @if(terminoBusqueda){
        <ion-list>
            @for (p of productosFiltrados; track p){
                <ion-card [routerLink]="paginaFinal" (click)="comunicarDatos(p.id, p.tipo, p.color, p.talla, p.cantidad, p.modelo)">
                    <ion-card-header>
                        <ion-card-title>{{ p.tipo }}</ion-card-title>
                        @if(p.modelo){<ion-card-subtitle>{{ p.modelo }}</ion-card-subtitle>}

                    </ion-card-header>
                    <ion-card-content>
                        @if (p.color){<p>Color: {{ p.color }}</p>}
                        @if (p.talla){<p>Talla: {{ p.talla }}</p>}
                    </ion-card-content>                
                </ion-card>       
            }
        </ion-list>
        }
        
    </div>

</ion-content>
